<!DOCTYPE html>
<html lang="en-us">
  <head>
  <title>Jason Eckert&#39;s Website and Blog</title>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta name="description" content="My personal website and blog" />
  <meta name="author" content="Jason Eckert" />
  <meta name="generator" content="Jason Eckert Hugo 0.110.0" />

  <link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
    crossorigin="anonymous"
  />
  <link
    rel="stylesheet"
    href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
  />
  <link
    href="https://fonts.googleapis.com/css?family=Overlock|Roboto+Mono&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="/css/mero.css" />

  <script src="/js/mero.js"></script>
</head>

  <body class="bg-dark text-white m-auto" style="width:95%; max-width: 1024px;">
    <div class="wrapper">
      <nav class="mb-3 mt-3 ml-1">
  <div class="d-flex flex-row">
    <div
      class="menu-item border border-warning bg-dark p-2"
      style="border-top-left-radius: 10px; border-bottom-left-radius: 10px;"
    >
      <a href="/"><span>Home</span> </a>
    </div>
    <div class="menu-item dropdown border border-warning bg-dark p-2">
      <span class="dropbtn text-warning" onclick="toggleMenu(this)"
        >Sections <i class="fas fa-angle-down"></i
      ></span>
      <div
        class="dropdown-content p-2 bg-dark2 mt-2 rounded w-auto mt-1 d-none"
        style="min-width: 200px;"
      >
        <ul class="list-unstyled">
          
          
          
          <li class="pt-2">
            <a href="https://jasoneckert.github.io/myblog/">Blog Posts</a>
          </li>
          
          
          
          
          <li class="pt-2">
            <a href="https://jasoneckert.github.io/bio/">About Me</a>
          </li>
          
          
          
          
          <li class="pt-2">
            <a href="https://jasoneckert.github.io/reads/">Recommended Reads</a>
          </li>
          
          
          
          
          <li class="pt-2">
            <a href="https://jasoneckert.github.io/info/">Tech Stuff</a>
          </li>
          
          
          
          
          
          
          
          
        </ul>
      </div>
    </div>
    <div class="menu-item border border-warning bg-dark p-2">
      <a
        href="/alltaxa/"
        ><span>Search</span>
      </a>
    </div>
    <div class="menu-item border border-warning bg-dark p-2"
    style="border-top-right-radius: 10px; border-bottom-right-radius: 10px;">
      <a
        href="/archive/"
        ><span>Archive</span>
      </a>
    </div>
  </div>
</nav>

      <main>
        
<article class="border rounded p-3 position-relative" style="margin-top: 2.5em;">
  <div class="header">
    <h1 style="font-size: 2.5em;">
      Installing a fast Linux server on an M1-based Mac
    </h1>
    <div
    class="mb-1 mr-3 pl-1 pr-1 rounded bg-dark"
    style="position: absolute; top: -19px; font-size: 0.9em;"
  >
    <time>2021-11-15</time>    
    <span
      class="more"
      style="font-size: 1.5em;"
      title="Show Metadata"
      onclick="showMetadata(this)"
    >
      &#43;
    </span>
  </div><div class="m-2 metadata overflow-hidden" style="max-height: 0px;">
  
  <div class="metadata-value mb-1 taxa taxa-container-div list-sections">
    <div>
      Reading Time: 
5 mins
      
    </div>
    <div>
      Section:
      <a
        class="pl-1 pr-1 rounded border border-secondary"
        href="/myblog"
        title="Section"
      >Blog Posts</a>
    </div>
  </div>
  

  
  
  
  <div class="metadata-value mb-1 taxa taxa-container-div list-categories">
    Categories:
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/categories/blog"
      title="categories"
    >blog</a>
    
  </div>
  
  
  
  <div class="metadata-value mb-1 taxa taxa-container-div list-tags">
    Tags:
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/tech"
      title="tags"
    >tech</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/apple"
      title="tags"
    >Apple</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/computing"
      title="tags"
    >computing</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/unix"
      title="tags"
    >UNIX</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/it"
      title="tags"
    >IT</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/macos"
      title="tags"
    >macOS</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/linux"
      title="tags"
    >Linux</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/development"
      title="tags"
    >development</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/programming"
      title="tags"
    >programming</a>
    
  </div>
  
  
</div>
</div>
  <div class="article pb-3 pt-3 border-bottom border-top">
    
    <p>One of the biggest worries that IT users have regarding Apple&rsquo;s new ARM-based M1 platform is the ability to run <em><strong>virtual machines (VMs)</strong></em> of other operating systems using hypervisor software. And while it&rsquo;s possible to run virtual machines of both Windows and Linux operating systems made for the Intel platform on the M1, the performance cost of translating Intel instructions to ARM is high (even with the optimizations Apple has within their M1 CPU). Luckily, the most common VM that an IT systems administrator or developer will install is Linux, and ARM versions of Linux have been mainstream for well over a decade now.</p>
<p>Instead of buying an expensive Parallels or VMWare Fusion license to run a VM of Linux (slowly) on the M1, you can use the free <em><strong>UTM</strong></em> app. UTM leverages the native hypervisor framework in macOS alongside the open source Qemu framework that is used for virtualizing operating systems on Linux. If you run an Intel version of Linux in UTM, Qemu will translate the Intel instructions to run on the M1 and there will be a noticable performance cost. However, if you run an ARM version of Linux in UTM, Qemu will run it directly on the M1 at near native speed. Better yet, the VirtIO storage bus used by Qemu and the Linux kernel can access the underlying storage in the Mac at near native speed. In short, UTM allows you to run ARM-based Linux VMs very very fast on the M1 platform for free.</p>
<p>To get started, you should first download an ARM-based Linux distribution. If you need a graphical desktop, I recommend the latest version of Fedora Workstation (shown below in UTM). If you just want to host a server (no graphical desktop), I recommend Ubuntu Server as it will likely be the same one hosting your services and Web apps in the cloud. You can visit <a href="https://getfedora.org/en/workstation/download/">https://getfedora.org/en/workstation/download/</a> to download the DVD ISO image for the latest Fedora Workstation (aarch64) or <a href="https://ubuntu.com/download/server">https://ubuntu.com/download/server</a> to download the DVD ISO image for the latest Ubuntu Server (ARM).</p>
<p><img src="fedora-arm.png#center" alt="ARM Powered logo" title="ARM Powered logo"></p>
<p>Next, you can perform the following steps to create a Linux server VM using UTM:</p>
<ol>
<li>Download the free version of UTM from <a href="https://mac.getutm.app">https://mac.getutm.app</a> and copy it to your Applications folder.</li>
<li>Open UTM and click <code>+</code> to create a new VM and click <code>Virtualize</code>, and <code>Linux</code>.</li>
<li>On the Linux page, deselect <code>Use Apple Virtualization</code> (this ensures you are also using Qemu - not just the native hypervisor framework in macOS). Click <code>Browse</code>, select the DVD ISO image you downloaded and click <code>Next</code>.</li>
<li>On the Hardware page, specify the amount of memory you&rsquo;d like to give your VM and click <code>Next</code>. For Linux with a graphical desktop (e.g. Fedora Workstation), specify <code>4096 MB</code> to give your VM 4GB of memory. For a Linux server without a graphical desktop (e.g. Ubuntu Server), specify <code>1024 MB</code> to give your VM 1GB of memory.</li>
<li>On the Storage page, specify the size of the dynamically-expanding virtual hard disk file that will be created and click <code>Next</code>. The default value is <code>64 GB</code>, but you can increase this value to accomodate the software you plan on installing on your Linux VM.</li>
<li>On the Shared Directory page, optionally click <code>Browse</code> and select a folder on your system that you&rsquo;d like to be made available to your VM for easy file transfer. Click <code>Next</code> when finished.</li>
<li>On Summary page, specify a name for your VM and click <code>Save</code>.</li>
<li>Click the Play icon next to your new VM to boot it from the virtual DVD ISO image. Some distributions validate the checksum of the DVD first. If you see a black window with the UTM logo in it for a few minutes, be patient - your Linux installer will start after the checksum is verified.</li>
<li>Install your Linux distribution as you normally would. The virtual hard disk file show up as <code>/dev/vda</code> instead of <code>/dev/sda</code> because we&rsquo;re using the very fast VirtIO interface instead of emulating a SCSI, SATA or NVMe interface.</li>
</ol>
<p>During the Linux installation, you&rsquo;ll be prompted to create a regular user account (e.g. jason). While this first user account is automatically added to the wheel or sudo group on your Linux distribution to allow it to run administrative commands as the root user, you should set the root user password following installation using the <code>sudo passwd root</code> command.</p>
<p>If you are a developer that needs a local Linux server for testing your Web apps, you&rsquo;ll need to install additional software packages. For example, to install the Apache Web server, Very Secure FTP daemon (for uploading files), MySQL/MariaDB database server, and PHP (including the most useful plugins) on an Ubuntu Server, you could switch to the root user (<code>su -</code>) and run the following commands:</p>
<pre tabindex="0"><code>apt update
apt upgrade
apt install apache2 vsftpd mysql-server 
mysql_secure_installation    #Configure your MySQL settings and password
apt install php libapache2-mod-php php-mysql phpmyadmin php-mbstring php-zip php-gd php-json php-curl
vi /etc/apache2/mods-enabled/dir.conf    #Add index.php to the DirectoryIndex line
systemctl restart apache2
</code></pre><p>While UTM can run ARM Linux at near native speed on macOS, you&rsquo;ll soon be able to install Linux natively on M1 hardware, eliminating the need for macOS entirely. Most of this development is already done by those working on the Asahi Linux project. Visit <a href="https://asahilinux.org/about/">https://asahilinux.org/about/</a> to learn more.</p>

  </div>
  <div class="mt-4 d-flex flex-row justify-content-around">
  <div>
    <a
      href="/myblog/kubernetes-quickstart/"
      data-toggle="tooltip"
      data-placement="top"
      title="Kubernetes Quickstart"
      ><i class="fas fa-chevron-circle-left" style="font-size: 2em;"></i></a
    >
  </div>
  <div>
    <a
      href="/myblog/arm-on-the-desktop/"
      data-toggle="tooltip"
      data-placement="top"
      title="ARM on the desktop is here to stay"
      ><i class="fas fa-chevron-circle-right" style="font-size: 2em;"></i></a
    >
  </div>
</div>

</article>
<script>
  let showMetadata = function(x) {
    let elem = x.parentNode.nextElementSibling;
    if (window.getComputedStyle(elem)["height"] === "0px") {
      elem.style.maxHeight = elem.scrollHeight + "px";
      x.innerHTML = "&times;";
      x.title = "Hide Metadata";
    } else {
      elem.style.maxHeight = "0px";
      x.innerHTML = "&#43;";
      x.title = "Show Metadata";
    }
  };
</script>


      </main>
    </div>
    <footer>
  <div class="w-60 bg-danger ml-auto mr-auto mt-4" style="height: 4px;"></div>
  <div class="mt-0 mb-0" style="font-size: 1.9em;">
    <p class="text-center">
      WARNING: FULL FRONTAL NERDITY 
    </p>
  </div>
  <div class="mt-0 mb-0" style="font-size: 1.0em;">
    <p class="text-center">
      (Tech-challenged persons strongly cautioned) 
    </p>
  </div>
</footer>

  </body>
</html>

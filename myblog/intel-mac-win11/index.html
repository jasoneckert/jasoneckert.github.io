<!DOCTYPE html>
<html lang="en-us">
  <head>
  <title>Jason Eckert&#39;s Website and Blog</title>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta name="description" content="My personal website and blog" />
  <meta name="author" content="Jason Eckert" />
  <meta name="generator" content="Jason Eckert Hugo 0.119.0" />

  <link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
    crossorigin="anonymous"
  />
  <link
    rel="stylesheet"
    href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
  />
  <link
    href="https://fonts.googleapis.com/css?family=Overlock|Roboto+Mono&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="/css/mero.css" />

  <script src="/js/mero.js"></script>
</head>

  <body class="bg-dark text-white m-auto" style="width:95%; max-width: 1024px;">
    <div class="wrapper">
      <nav class="mb-3 mt-3 ml-1">
  <div class="d-flex flex-row">
    <div
      class="menu-item border border-warning bg-dark p-2"
      style="border-top-left-radius: 10px; border-bottom-left-radius: 10px;"
    >
      <a href="/"><span>Home</span> </a>
    </div>
    <div class="menu-item dropdown border border-warning bg-dark p-2">
      <span class="dropbtn text-warning" onclick="toggleMenu(this)"
        >Sections <i class="fas fa-angle-down"></i
      ></span>
      <div
        class="dropdown-content p-2 bg-dark2 mt-2 rounded w-auto mt-1 d-none"
        style="min-width: 200px;"
      >
        <ul class="list-unstyled">
          
          
          
          <li class="pt-2">
            <a href="https://jasoneckert.github.io/myblog/">Blog Posts</a>
          </li>
          
          
          
          
          <li class="pt-2">
            <a href="https://jasoneckert.github.io/bio/">About Me</a>
          </li>
          
          
          
          
          <li class="pt-2">
            <a href="https://jasoneckert.github.io/site/">My Policy on AI</a>
          </li>
          
          
          
          
          <li class="pt-2">
            <a href="https://jasoneckert.github.io/reads/">Recommended Reads</a>
          </li>
          
          
          
          
          <li class="pt-2">
            <a href="https://jasoneckert.github.io/trails/">Recommended Trails</a>
          </li>
          
          
          
          
          <li class="pt-2">
            <a href="https://jasoneckert.github.io/info/">Tech Stuff</a>
          </li>
          
          
          
          
          
          
          
          
        </ul>
      </div>
    </div>
    <div class="menu-item border border-warning bg-dark p-2">
      <a
        href="/alltaxa/"
        ><span>Search</span>
      </a>
    </div>
    <div class="menu-item border border-warning bg-dark p-2"
    style="border-top-right-radius: 10px; border-bottom-right-radius: 10px;">
      <a
        href="/archive/"
        ><span>Archive</span>
      </a>
    </div>
  </div>
</nav>

      <main>
        
<article class="border rounded p-3 position-relative" style="margin-top: 2.5em;">
  <div class="header">
    <h1 style="font-size: 2.5em;">
      Extending the life of an Intel-based Mac using Windows 11
    </h1>
    <div
    class="mb-1 mr-3 pl-1 pr-1 rounded bg-dark"
    style="position: absolute; top: -19px; font-size: 0.9em;"
  >
    <time>2024-01-02</time>    
    <span
      class="more"
      style="font-size: 1.5em;"
      title="Show Metadata"
      onclick="showMetadata(this)"
    >
      &#43;
    </span>
  </div><div class="m-2 metadata overflow-hidden" style="max-height: 0px;">
  
  <div class="metadata-value mb-1 taxa taxa-container-div list-sections">
    <div>
      Reading Time: 
9 mins
      
    </div>
    <div>
      Section:
      <a
        class="pl-1 pr-1 rounded border border-secondary"
        href="/myblog"
        title="Section"
      >Blog Posts</a>
    </div>
  </div>
  

  
  
  
  <div class="metadata-value mb-1 taxa taxa-container-div list-categories">
    Categories:
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/categories/blog"
      title="categories"
    >blog</a>
    
  </div>
  
  
  
  <div class="metadata-value mb-1 taxa taxa-container-div list-tags">
    Tags:
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/tech"
      title="tags"
    >tech</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/computing"
      title="tags"
    >computing</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/it"
      title="tags"
    >IT</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/apple"
      title="tags"
    >Apple</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/macos"
      title="tags"
    >macOS</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/windows"
      title="tags"
    >Windows</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="/tags/microsoft"
      title="tags"
    >Microsoft</a>
    
  </div>
  
  
</div>
</div>
  <div class="article pb-3 pt-3 border-bottom border-top">
    
    <p>Back in 2020, Apple introduced the first Macs that used Apple Silicon processors instead of Intel ones, and this transition from Intel to Apple Silicon was completed earlier this year across Apple&rsquo;s entire product line. While Apple promised they&rsquo;d continue supporting macOS on Intel-based Macs for the near future, those of us who remember Apple&rsquo;s previous transitions from M68k-to-PowerPC and PowerPC-to-Intel know full well that this support is going to end sooner than later. Even the last two versions of macOS have far fewer features when run on Intel Macs.</p>
<p>So, what does this mean for those of us who still have a fairly recent Intel-based Mac? It means that if you want to continue running the latest version of an operating system in the future, it won&rsquo;t be macOS. That leaves Linux and Windows.</p>
<p>Linux installs normally on older Intel-based Macs, and with some extra work <a href="https://wiki.t2linux.org/">can also be installed on newer (2018+) Macs with a T2 security chip</a>. However, installing Linux is often a bit too difficult for most Mac users, and Linux itself is an operating system that requires a bit more technical savvy compared to macOS and Windows (which is why it&rsquo;s loved by those of us who work in tech).</p>
<p>When it comes to Windows, Apple fully supports running Windows 10 on most Intel-based Macs introduced after 2012, and also allows for secure boot. Unfortunately, they do not officially support the latest version of Windows (Windows 11) due to the hardware Trusted Platform Module (TPM) version 2.0 requirement that Macs simply do not have. Luckily, you can still install and run Windows 11 on your Intel-based Mac just fine if you bypass the TPM requirement (something that Microsoft allows for lab environments, such as a classroom). Running Windows 11 without a TPM only disables a few of the extra security features available within Microsoft Defender, leaving the vital ones intact. By installing Windows 11 on your Intel-based Mac, you&rsquo;ll be able to run the latest Windows operating system from Microsoft alongside robust driver support from Apple.</p>
<p><img src="desktop.png#center" alt="Windows 11 on a MacBook Pro" title="Windows 11 on a MacBook Pro"></p>
<p>Â </p>
<h1 id="step-1-first-install-windows-10-using-the-boot-camp-assistant">Step 1: First install Windows 10 using the Boot Camp Assistant</h1>
<p>The easiest (and fastest) way to install Windows 11 on an Intel-based Mac is to first install Windows 10 using the Boot Camp Assistant program that comes with macOS, and then overwrite that Windows 10 installation with Windows 11. Boot Camp Assistant will shrink your macOS volume and prepare the correct partitions and filesystems needed for Windows 11.</p>
<p>To do this, you need to download a Windows 10 ISO image from Microsoft. Next, you run the Boot Camp Assistant program, choose the Windows 10 ISO image, choose how much space to allocate to Windows, and then follow the prompts to start and complete the Windows installation. Following the installation, the Boot Camp Assistant also installs the Apple-specific Windows device drivers for your system. This entire process is <a href="https://support.apple.com/en-ca/guide/bootcamp-assistant/bcmp173b3bf2/mac">detailed on Apple&rsquo;s website here</a>.</p>
<p>After you have Windows 10 installed on your Mac, you can press and hold the Option key (or Alt key if you use a Windows keyboard) during boot to select between Windows and macOS. Within macOS, you can choose the default operating system to boot within macOS System Settings (General &gt; Startup Disk). You can also choose the default operating sytem to boot within Windows using the Boot Camp Control Panel, which you can start by clicking the Boot Camp icon in the notification area as shown here:</p>
<p><img src="bootcamp_control_panel.png#center" alt="Boot Camp Control Panel" title="Boot Camp Control Panel"></p>
<h1 id="step-2-prepare-a-usb-drive-with-windows-11">Step 2: Prepare a USB drive with Windows 11</h1>
<p><img src="hub.png#right" alt="USB-C to USB-A hub" title="USB-C to USB-A hub">
After you have Windows 10 installed on your Intel-based Mac, you can now use it to create Windows 11 installation media. Navigate to <a href="https://www.microsoft.com/en-ca/software-download/windows11">Windows 11 download site</a> in your browser and choose the option to create Windows 11 Installation Media. This will download and run a small program. When you execute this program, choose the options that will allow it to download and write Windows 11 installation media to a 8GB+ USB flash drive.</p>
<p>If your flash drive is USB-A and your Mac only has USB-C ports (e.g., a 2015+ MacBook), you may need to get a USB-C to USB-A (USB 3.0) adapter. Alternatively, you could get a USB-C to USB-A (USB 3.0) hub to provide multiple USB-A ports as shown here.</p>
<h1 id="step-3-add-bootcamp-drivers-to-usb-drive">Step 3: Add Bootcamp drivers to USB drive</h1>
<p>After you&rsquo;ve created Windows 11 installation media on a USB flash drive, you must add the Apple device drivers from the Boot Camp Assistant to it. To do this, click the Boot Camp icon in the notification area and choose &ldquo;Restart in macOS&rdquo;. Next, reboot your system to boot into macOS.</p>
<p>Once in macOS, run the Boot Camp Assistant program again, but don&rsquo;t progress through the wizard. Instead click the Action menu, choose &ldquo;Download Windows Support Software&rdquo;, then choose your USB flash drive as the save destination. This will download the Apple drivers for Windows 10 (which also work in Windows 11) to the same USB flash drive that contains the Windows 11 installation media. When this has completed, you can close Boot Camp Assistant and shut down your computer.</p>
<h1 id="step-4-procure-a-usb-keyboard-and-mouse-if-necessary">Step 4: Procure a USB keyboard and mouse (if necessary)</h1>
<p>The Windows 11 installation program that we&rsquo;ll start in the next step won&rsquo;t have the drivers for a MacBook keyboard and trackpad or Apple Bluetooth keyboard or mouse until we install them manually following the Windows 11 installation. As a result, you&rsquo;ll need to have a USB keyboard and mouse handy that you can plug into your Mac once the installation program starts to navigate through the Windows 11 installation process. As discussed in the previous step, you can use a USB-C to USB-A (USB 3.0) adapter or hub if your keyboard and mouse use a USB-A style connector instead of USB-C.</p>
<p>Of course, if you use a Mac that already uses a USB keyboard and mouse, then you&rsquo;re all set.</p>
<h1 id="step-5-install-windows-11-bypassing-tpm-requirement">Step 5: Install Windows 11 (bypassing TPM requirement)</h1>
<p>Ensure that your USB keyboard, mouse, and flash drive are inserted in your Mac and then press and hold the Option key (or Alt key if you use a Windows keyboard) while powering on the system. At the boot selection screen, choose to boot from your USB flash drive to start the Windows 11 installation process. Note that you&rsquo;ll need to use the USB keyboard and mouse during the installation process.</p>
<p>If you proceed normally through the installation, you&rsquo;ll get the âThis PC canât run Windows 11â error message shown below (because your Mac lacks a TPM).</p>
<p><img src="error.png#center" alt="Windows 11 install error" title="Windows 11 install error"></p>
<p>To avoid this, at the beginning of the Windows 11 installation process:</p>
<ul>
<li>Press Shift+F10 to open a command prompt and run <code>regedit.exe</code> to launch the Registry Editor.</li>
<li>Navigate to <code>HKEY_LOCAL_MACHINE\SYSTEM\Setup</code></li>
<li>Right-click on the Setup key in the left pane and choose New -&gt; Key. Call this key <code>LabConfig</code>.</li>
<li>Right-click the LabConfig key in the left pane and choose New -&gt; DWORD (32-bit) Value. Call this value <code>BypassTPMCheck</code>.</li>
<li>Right-click the LabConfig key in the left pane and choose New -&gt; DWORD (32-bit) Value. Call this value <code>BypassSecureBootCheck</code>.</li>
<li>Double-click both the BypassTPMCheck and BypassSecureBootCheck values and change the Value data from <code>0</code> to <code>1</code>.</li>
<li>Close the Registry Editor and command prompt windows. You can now proceed through the installation normally.</li>
</ul>
<h1 id="step-6-install-bootcamp-drivers">Step 6: Install Bootcamp drivers</h1>
<p>After Windows has installed, follow the prompts to create a user account and system options (location services, etc.). Once you get to the Windows desktop, open File Explorer and navigate to your USB flash drive (e.g., <code>D:\</code>), open the <code>Windows Support\BootCamp</code> folder and run <code>Setup.exe</code> to install the Apple device drivers. Reboot when finished. After you reboot, you should no longer need the USB keyboard and mouse.</p>
<p>Next, right-click Start and choose Device Manager. If you see unknown devices listed, right click each one in turn, click &ldquo;Update driver&rdquo;, select &ldquo;Browse my computer for drivers&rdquo; and navigate to the <code>Windows Support\BootCamp</code> folder on your USB flash drive to locate the correct driver. I had to do this for four devices on my system.</p>
<h1 id="step-7-perform-post-installation-configuration">Step 7: Perform post-installation configuration</h1>
<p>Next, you&rsquo;ll want to perform some key Windows 11 post-installation configuration tasks, including:</p>
<ul>
<li>Connect to the Internet if you use Wi-Fi. You can either select the network icon in the notification area, or right-click Start, select System, and click &ldquo;Network &amp; internet&rdquo;. If you have a wired Ethernet connection, you should be able to see your existing network configuration here.</li>
<li>Activate Windows 11. To activate or check your activation status, right-click Start, select System, and then click &ldquo;Product key and activation&rdquo;. If you have a wired Ethernet connection, Windows 11 likely activated during the installation process.</li>
<li>Perform updates. Right-click Start, select System, and then click &ldquo;Windows Update&rdquo;. Do not perform any optional driver updates as they could update an existing Apple device driver (I did this and had to reinstall the Apple drivers to get my sound back).</li>
<li>Set your preferred display, keyboard,and trackpad settings. These can be configured in the Boot Camp Control Panel discussed earlier. For MacBook users, you&rsquo;ll want to configure the right-click behaviour for the trackpad at minimum.</li>
<li>Optionally customize your desktop wallpaper. To do this, right click your desktop and click Personalize, Background. If you like the macOS-style Windows wallpaper I use, you can download it <a href="windows_wallpaper.jpg">here</a>.</li>
<li>Optionally move the Taskbar postition to the left of the screen (the default centered position in Windows 11 doesn&rsquo;t provide for a consistent Start button location as items are added to the Taskbar). To do this, right-click the Taskbar, click Taskbar Settings, and choose Left from the &ldquo;Taskbar behaviors&rdquo; dropdown box.</li>
<li>Verify security settings. Click the Windows Security icon in the notification area. In the &ldquo;Device security&rdquo; section, note that secure boot is enabled, but there is a warning next to &ldquo;Security processor&rdquo; indicating that a TPM is not available. Click Dismiss to remove that warning.</li>
</ul>
<p><img src="windows_device_security.png#center" alt="Windows Device Security Settings" title="Windows Device Security Settings"></p>
<h1 id="step-8-install-and-configure-additional-sofware">Step 8: Install and configure additional sofware</h1>
<p>Finally, you&rsquo;ll want to configure your system with the usual software you use. Most likely this will include Microsoft Office 365, Teams, and Steam. However, if you run virtual machines, you&rsquo;ll want to install the Hyper-V feature, which requires you chose the Windows 11 Pro, Enterprise, or Educational edition during installation. If you develop web apps or manage Linux systems, you&rsquo;ll likely want to install the Windows Subsystem for Linux (WSL) feature and a Linux distribution. For example, to install Ubuntu Linux, you could run the <code>wsl --install --distribution ubuntu</code> command within a PowerShell window with Administrator rights.</p>
<p>The Windows 11 Enterprise N edition is a European version of Enterprise edition that omits the Windows Media Player and Media Feature Pack. If you chose this distribution during installation, you will get warnings from games and the Radeon control software about missing DLLs (e.g., MFReadWrite.dll and MFPlat.dll). In this case, you can install the Windows Media Player and Media Feature Pack manually afterwards. To do this, open a PowerShell window with Administrator rights and execute the <code>Get-WindowsCapability -online | Where-Object -Property name -like &quot;*media*&quot; | Add-WindowsCapability -Online</code> command.</p>
<p>That&rsquo;s it - you now have the latest version of Windows running on your Intel Mac!</p>

  </div>
  <div class="mt-4 d-flex flex-row justify-content-around">
  <div>
    <a
      href="/myblog/40-years-of-mac/"
      data-toggle="tooltip"
      data-placement="top"
      title="40 years of Macintosh"
      ><i class="fas fa-chevron-circle-left" style="font-size: 2em;"></i></a
    >
  </div>
  <div>
    <a
      href="/myblog/2023-in-review/"
      data-toggle="tooltip"
      data-placement="top"
      title="2023 in Review"
      ><i class="fas fa-chevron-circle-right" style="font-size: 2em;"></i></a
    >
  </div>
</div>
<script src="https://giscus.app/client.js"
          data-repo="jasoneckert/jasoneckert.github.io"
          data-repo-id="MDEwOlJlcG9zaXRvcnkyMzUyMTE1MTk="
          data-category="Announcements"
          data-category-id="DIC_kwDODgUK_84ChWDV"
          data-mapping="pathname"
          data-strict="0"
          data-reactions-enabled="0"
          data-emit-metadata="0"
          data-input-position="bottom"
          data-theme="noborder_gray"
          data-lang="en"
          crossorigin="anonymous"
          async>
       </script>


</article>
<script>
  let showMetadata = function(x) {
    let elem = x.parentNode.nextElementSibling;
    if (window.getComputedStyle(elem)["height"] === "0px") {
      elem.style.maxHeight = elem.scrollHeight + "px";
      x.innerHTML = "&times;";
      x.title = "Hide Metadata";
    } else {
      elem.style.maxHeight = "0px";
      x.innerHTML = "&#43;";
      x.title = "Show Metadata";
    }
  };
</script>


      </main>
    </div>
    <footer>
  <div class="w-60 bg-danger ml-auto mr-auto mt-4" style="height: 4px;"></div>
  <div class="mt-0 mb-0" style="font-size: 1.7em;">
    <p class="text-center">
      WARNING: FULL FRONTAL NERDITY (tech-challenged persons strongly cautioned) 
    </p>
  </div>
</footer>

  </body>
</html>

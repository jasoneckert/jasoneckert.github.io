<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="Generator" content="iWeb 3.0.2" />
    <meta name="iWeb-Build" content="local-build-20200627" />
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
    <meta name="viewport" content="width=700" />
    <title>Microsoft ReFS vs Oracle ZFS - FIGHT</title>
    <link rel="stylesheet" type="text/css" media="screen,print" href="25_Microsoft_ReFS_vs_Oracle_ZFS_-_FIGHT_files/25_Microsoft_ReFS_vs_Oracle_ZFS_-_FIGHT.css" />
    <!--[if lt IE 8]><link rel='stylesheet' type='text/css' media='screen,print' href='25_Microsoft_ReFS_vs_Oracle_ZFS_-_FIGHT_files/25_Microsoft_ReFS_vs_Oracle_ZFS_-_FIGHTIE.css'/><![endif]-->
    <!--[if gte IE 8]><link rel='stylesheet' type='text/css' media='screen,print' href='../../../../Media/IE8.css'/><![endif]-->
    <script language="javascript" type="text/javascript"><!--

iWebBlogMainPageName = 'blog.html';
iWebBlogMainPageTitle = 'blog';
iWebBlogArchivePageName = 'Archive.html';
iWebBlogArchivePageTitle = 'Archive';


--></script>
    <script type="text/javascript" src="../../../../Scripts/iWebSite.js"></script>
    <script type="text/javascript" src="../../../../Scripts/Widgets/SharedResources/WidgetCommon.js"></script>
    <script type="text/javascript" src="../../../../Scripts/Widgets/Navbar/navbar.js"></script>
    <script type="text/javascript" src="http://www.me.com/1/up/comments/scripts/search.js"></script>
    <script type="text/javascript" src="../../../../Scripts/iWebBlog.js"></script>
    <script type="text/javascript" src="../../../../Scripts/iWebImage.js"></script>
    <script type="text/javascript" src="25_Microsoft_ReFS_vs_Oracle_ZFS_-_FIGHT_files/25_Microsoft_ReFS_vs_Oracle_ZFS_-_FIGHT.js"></script>
  </head>
  <body style="background: rgb(247, 246, 246); margin: 0pt; " onload="onPageLoad();" onunload="onPageUnload();">
    <div style="text-align: center; ">
      <div style="margin-bottom: 0px; margin-left: auto; margin-right: auto; margin-top: 0px; overflow: hidden; position: relative; word-wrap: break-word;  background: rgb(247, 246, 246); text-align: left; width: 700px; " id="body_content">
        <div style="float: left; height: 0px; line-height: 0px; margin-left: 0px; position: relative; width: 700px; z-index: 10; " id="header_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
        </div>
        <div style="margin-left: 0px; position: relative; width: 700px; z-index: 0; " id="nav_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div style="height: 1px; line-height: 1px; " class="tinyText"> </div>
          <div class="com-apple-iweb-widget-navbar flowDefining" id="widget0" style="margin-left: 0px; margin-top: 24px; opacity: 1.00; position: relative; width: 700px; z-index: 1; ">
    
            <div id="widget0-navbar" class="navbar">

      
              <div id="widget0-bg" class="navbar-bg">

        
                <ul id="widget0-navbar-list" class="navbar-list">
 <li></li> 
</ul>
                
      
</div>
              
    
</div>
          </div>
          <script type="text/javascript"><!--//--><![CDATA[//><!--
new NavBar('widget0', '../../../../Scripts/Widgets/Navbar', '../../../../Scripts/Widgets/SharedResources', '../../../..', {"path-to-root": "..\/..\/..\/..\/", "navbar-css": ".navbar {\n\tfont-family: 'Helvetica Neue', Arial, sans-serif;\n\tfont-size: .85em;\n\tcolor: #999;\n\tmargin: 0px;\n\tline-height: 20px;\n\tfont-weight: bold;\n}\n\n.navbar-bg {\n\ttext-align: left;\n\tpadding: 0px;\n}\n\n.navbar-bg ul {\n\tlist-style: none;\n\tmargin: 0px;\n\tpadding: 0px;\n}\n\n\nli {\n\tlist-style-type: none;\n\tdisplay: inline;\n\tpadding: 0px 15px 0px 10px;\n}\n\n\nli a {\n\ttext-decoration: none;\n\tcolor: #999;\n}\n\nli a:visited {\n\ttext-decoration: none;\n\tcolor: #999;\n}\n\nli a:hover\n{\n \tcolor: #F00;\n\ttext-decoration: none;\n}\n\n\nli.current-page a\n{\n\t color: #666;\n\ttext-decoration: none;\n\n}", "current-page-GUID": "3F9CBE75-F5BD-4B35-9E50-35A3B3B60A4E", "isCollectionPage": "YES"});
//--><!]]></script>
          <div style="clear: both; height: 0px; line-height: 0px; " class="spacer"> </div>
        </div>
        <div style="margin-left: 0px; position: relative; width: 700px; z-index: 5; " id="body_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div id="id1" style="visibility: hidden;  height: 41px; left: 40px; position: absolute; top: 416px; width: 620px; z-index: 1; " class="style_SkipStroke shape-with-text">
            <div class="text-content Normal_External_620_41" style="padding: 0px; ">
              <div class="Normal">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="Title"><span class="Color">Microsoft ReFS vs Oracle ZFS - FIGHT</span></p>
              </div>
            </div>
            <div id="generic-title-attributes" class="Title"></div>
          </div>
          


          <div id="id2" style="visibility: hidden;  height: 41px; left: 40px; position: absolute; top: 448px; width: 620px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content style_External_620_41" style="padding: 0px; ">
              <div class="style">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="Date">Tuesday, February 25, 2014</p>
              </div>
            </div>
            <div id="generic-datefield-attributes" class="Date"></div>
          </div>
          <div style="height: 1px; line-height: 1px; " class="tinyText"> </div>
          <div style="visibility: hidden;  margin-left: 40px; margin-top: 488px; position: relative; width: 620px; z-index: 1; " class="style_SkipStroke_3 shape-with-text flowDefining">
            <div class="text-content style_External_620_4616" style="padding: 0px; ">
              <div class="style">
                <p style="padding-top: 0pt; " class="Body">Last night, I gave a presentation at <span class="style_1">WWITPRO (Waterloo Wellington IT Professional Users Group) </span>that involved 3 mini presentations (to keep it fresh):<br /></p>
                <p class="Body">1)  Windows Server 2012 in a nutshell (with cool demos)<br />2)  What is a Transputer and how did it shape today’s computing world?<br />3)  Microsoft ReFS vs Oracle ZFS - FIGHT! (with cool demos)<br /><br /></p>
                <p class="Body">The first two presentations don’t lend themselves well to a blog post since it’s mostly demos and show-and-tell.....but the third one does, so this post is going to summarize some of the stuff from that presentation.<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">In the past, most IT admins have put their faith in systems and <span class="style_1">SANs (Storage Area Networks)</span> that use <span class="style_1">RAID (Redundant Array of Inexpensive Disks)</span> technology.  RAID can be used to combine hard disks together into <span class="style_1">simple volumes</span> (called RAID-0, or JBOD) that aren’t fault tolerant, but can also be used to create <span class="style_1">mirrored volumes</span> where both drives are identical in case one fails (called RAID-1), or <span class="style_1">striped volumes with parity</span> where data is written across several disks with parity information that can be used to calculate the missing data if a drive fails (called RAID-5). <br /></p>
                <p class="Body"> <br /></p>
                <p class="Body">The biggest problem with this approach is that it only protects against hard disk failure.  What about the plethora of different problems that can corrupt data as it is actually written to the file system by the operating system itself?  These include:<br /></p>
                <ol>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Accidental driver overwrites<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Bit rot<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Disk firmware bugs<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Driver &amp; kernel buffer errors<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Misdirected writes<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Phantom writes<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Silent data corruption<br /> <br /></p>
                  </li>
                </ol>
                <p class="Body">Both ReFS and ZFS solve these problems at the file system level!  <br /></p>
                <p class="Body">More specifically, they both:<br /></p>
                <ol>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Detect and repair data errors in real time<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Accommodate volumes in the thousands of disks<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Support huge numbers of files<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Allow you to modify/resize volumes without taking the volume offline<br /> <br /></p>
                  </li>
                </ol>
                <p class="Body">Now let’s take a more in-depth look at each one…..starting with ZFS.<br /></p>
                <p class="Body"> <br /></p>
                <p class="paragraph_style_1">Zettabyte File System (ZFS):<br /></p>
                <ol>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Is a 128-bit filesystem.<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Has a capacity of 256 quadrillion Zettabytes (1 Zettabyte = 1 billion Terabytes)<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Has been around for a long time (first introduced in 2001, officially released in 2005)<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Is multi-platform (Solaris, Mac OSX, Linux, FreeBSD, FreeNAS, and more)<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Supports nearly all file system features (Deduplication, snapshots, cloning, compression, encryption, NFSv4, volume management, etc.)<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Has checksums built into its entire fabric – it’s very obvious that ZFS was designed to implement checksums in a very efficient way at every level.<br /> <br /></p>
                  </li>
                </ol>
                <p class="paragraph_style_1">ZFS Terminology:<br /></p>
                <p class="Body">ZFS pool = bunch of physical disks (managed with the <span class="style_2">zpool</span> command)<br /></p>
                <p class="Body">ZFS file systems = volumes created from ZFS pools (managed with the <span class="style_2">zpool</span> and <span class="style_2">zfs</span> commands)<br /></p>
                <p class="Body"> <br /></p>
                <p class="paragraph_style_1">Creating ZFS volumes:<br /></p>
                <p class="Body">I did this on an Oracle UltraSPARC server running Solaris 10, but you can pretty much use any operating system that has ZFS support installed.  You can give ZFS anything to use – you could give it a device file for a raw device, a partition, a volume, or even a file on a filesystem!  For ease, I’m going to create 3 simple files off of the root of my system to use:<br /></p>
                <p class="paragraph_style_2">  mkfile 256m /disk1<br /></p>
                <p class="paragraph_style_2">  mkfile 256m /disk2<br /></p>
                <p class="paragraph_style_2">  mkfile 256m /disk3<br /></p>
                <p class="Body"> <br /></p>
                <p class="Body">Next, I can create a simple ZFS volume from all three devices called lala, and automatically mount it to the /lala directory using a single command:<br /></p>
                <p class="paragraph_style_2">  zpool create lala /disk1 /disk2 /disk3<br /></p>
                <p class="Body"> <br /></p>
                <p class="Body">I can then copy files to /lala or check out the details using the <span class="style_2">zpool</span> command:<br /></p>
                <p class="paragraph_style_2">  cp /etc/hosts /lala<br /></p>
                <p class="paragraph_style_2">  ls -lh /lala<br /></p>
                <p class="paragraph_style_2">  zpool list<br /></p>
                <p class="Body"> <br /></p>
                <p class="Body">I can also remove the ZFS volume entirely and return to my original configuration:<br /></p>
                <p class="paragraph_style_2">  zpool destroy lala<br /></p>
                <p class="Body"> <br /></p>
                <p class="Body">Similarly, to create a mirror called po using just /disk1 and /disk2, and mount it to the /po directory, I could use:<br /></p>
                <p class="paragraph_style_2">  zpool create po mirror /disk1 /disk2<br /></p>
                <p class="paragraph_style_2">  zpool list<br /></p>
                <p class="paragraph_style_2">  cp /etc/hosts /lala<br /></p>
                <p class="paragraph_style_2">  zpool status po<br /></p>
                <p class="paragraph_style_2"> <br /></p>
                <p class="Body">If I overwrite part of /disk1 (simulating corruption) using the <span class="style_2">dd</span> command, I can use the <span class="style_2">zpool scrub</span> command to check for the error and then detach /disk1 (the failed disk) and attach /disk3 (a new disk).  Finally, I’ll check out some more detailed I/O stats and remove the po volume:<br /></p>
                <p class="paragraph_style_2">  dd if=/dev/random of=/disk1 bs=512 count=1<br /></p>
                <p class="paragraph_style_2">  zpool scrub po<br /></p>
                <p class="paragraph_style_2">  zpool status<br /></p>
                <p class="paragraph_style_2">  zpool detach po /disk1<br /></p>
                <p class="paragraph_style_2">  zpool status po<br /></p>
                <p class="paragraph_style_2">  zpool attach po /disk2 /disk3<br /></p>
                <p class="paragraph_style_2">  zpool list<br /></p>
                <p class="paragraph_style_2">  zpool status po<br /></p>
                <p class="paragraph_style_2">  zpool iostat -v po<br /></p>
                <p class="paragraph_style_2">  zpool destroy po<br /></p>
                <p class="Body"> <br /></p>
                <p class="Body">To do a striped volume with parity, you can use the keyword <span class="style_2">raidz</span> alongside the <span class="style_2">zpool</span> command.  RAID-Z is like RAID-5, but more intelligent because it uses a variable-sized stripe (hence the new name, RAID-Z)!  Like RAID-5, RAID-Z requires a minimum of 3 devices.  You can also use <span class="style_2">raidz2</span> (double parity like RAID-6, requires 4+ devices) and <span class="style_2">raidz3</span> (triple partity, requires 5+ devices).  Let’s just create a regular RAID-Z volume called noonoo and check it out:<br /></p>
                <p class="paragraph_style_2">  zpool create noonoo raidz /disk1 /disk2 /disk3<br /></p>
                <p class="paragraph_style_2">  zpool status noonoo<br /></p>
                <p class="paragraph_style_2">  zpool iostat -v noonoo<br /></p>
                <p class="Body"> <br /></p>
                <p class="Body">There is far more to ZFS than I’ll discuss here – you can resize/modify/whatever using various <span class="style_2">zpool</span> commands.  But what I’ll leave you with for now is that most of the cool features of the ZFS filesystem can be managed using the <span class="style_2">zfs</span> command.  For example, I could create three subdirectories under the /noonoo filesystem for three users using the <span class="style_2">zfs</span> command (which is better than simply using <span class="style_2">mkdir</span> to create them because it tells ZFS to keeps track of them):<br /></p>
                <p class="paragraph_style_2">  zfs create noonoo/larry<br /></p>
                <p class="paragraph_style_2">  zfs create noonoo/curly<br /></p>
                <p class="paragraph_style_2">  zfs create noonoo/moe<br /></p>
                <p class="paragraph_style_2">  zfs list<br /></p>
                <p class="Body"> <br /></p>
                <p class="Body">Now you could get a list of the properties for the /noonoo/larry subdirectory to see a list of things you could modify, or even set a quota for larry:<br /></p>
                <p class="paragraph_style_2">  zfs get all noonoo/larry<br /></p>
                <p class="paragraph_style_2">  zfs set quota=10G noonoo/larry<br /></p>
                <p class="Body"> <br /></p>
                <p class="paragraph_style_1">Resilient File System (ReFS):<br /></p>
                <ol>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Support Windows Server 2012+ / Windows 8+ only<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Is a 64-bit filesystem<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Has a capacity = 1 Yottabyte (=1024 Zettabytes)<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Puts 64-bit checksums on all metadata<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Puts 64-bit checksums on data (if integrity attribute set)<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>Has NO support for EFS, quotas, compression, 8.3 names, deduplication, etc. (Bitlocker is supported though)<br /> <br /></p>
                  </li>
                </ol>
                <p class="paragraph_style_1">ReFS Terminology:<br /></p>
                <p class="Body">Storage pool = a bunch of physical disks<br /></p>
                <p class="Body">Storage spaces = virtual disks / volumes made from storage pools (can be NTFS or ReFS)<br /></p>
                <p class="Body"> <br /></p>
                <p class="paragraph_style_1">Creating ReFS Volumes:<br /></p>
                <p class="Body">ReFS works with Storage Spaces to create either simple volumes from one or more disks, mirrored volumes (RAID-1, requires 2 devices), or parity volumes (RAID-5, requires 3+ devices).  ReFS automatically corrects file corruption on a parity space if the the integrity attribute is set (it is set by default on parity volumes, but can be changed using the Set-FileIntegrity cmdlet in PowerShell).<br /></p>
                <p class="Body"> <br /></p>
                <p class="Body">Unfortunately, you can’t just create a file and give it to Storage Spaces for creating ReFS volumes – you actually have to use real devices.  As a result, I’ve installed Windows Server 2012 R2 in a Hyper-V virtual machine and attached 3 additional 5GB virtual disks to it.<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">You can easily create a storage pool within Server Manager by navigating to <span class="style_1">File and Storage Services &gt; Volumes &gt; Storage Spaces</span>.  When you choose the appropriate Task option to create a Storage Space, you’ll get a wizard that asks you to choose the disks you want to put in the pool - you can then give it a name and complete the wizard.  At this point, you’ll have something that looks like this:<br /></p>
                <div class="paragraph Body"><div style="height: 317px; width: 610px;  height: 317px; position: relative; width: 610px; " class="tinyText style_SkipStroke_2 inline-block stroke_0 shadow_0"><img src="25_Microsoft_ReFS_vs_Oracle_ZFS_-_FIGHT_files/droppedImage.jpg" alt="" style="border: none; height: 318px; width: 611px; " /></div><br /></div>
                <p class="Body"><br /></p>
                <p class="Body">Next, you’ll want to choose the <span class="style_1">Tasks</span> menu in the Virtual Disks section shown above and create a new Storage Space volume.  This opens two wizards.  The first wizard asks you to choose the pool you want to use, and then give the Storage Space a name, layout (Simple, Mirror or Parity) and size.  The second wizard creates the filesystem on the Storage Space - it prompts you to choose your Storage Space, volume size, mount point (e.g. F:\), and file system (choose ReFS!!!).  And BOOM!  You’re done.  You should have a new volume listed under Virtual Disks:<br /></p>
                <div class="paragraph Body"><div style="height: 312px; width: 610px;  height: 312px; position: relative; width: 610px; " class="tinyText style_SkipStroke_2 inline-block stroke_0 shadow_1"><img src="25_Microsoft_ReFS_vs_Oracle_ZFS_-_FIGHT_files/droppedImage_1.jpg" alt="" style="border: none; height: 313px; width: 611px; " /></div><br /></div>
                <p class="Body"><br /></p>
                <p class="Body">OK, now for the performance comparison!  I’ve had the pleasure of being able to run both file systems in a production-class test environment, and bog them down using various software suites.  Here is what I’ve found from my experience:<br /></p>
                <p class="Body"> <br /></p>
                <p class="paragraph_style_1">ReFS Performance:<br /></p>
                <p class="Body">To say it is poor, would be very kind.  The parity (RAID-5) has dismal performance, especially if you simulate corruption.  Microsoft’s only solution to this is to add an SSD (it will move frequently-access stuff to the SSD – a feature called storage tier support).  Why is this?!?!?  Well, according to Microsoft, ReFS requires that existing parity information &quot;...be read and processed before a new write can occur.”  Archaic to say the least.<br /></p>
                <p class="Body">  <br /></p>
                <p class="paragraph_style_1">ZFS Performance:<br /></p>
                <p class="Body">Amazing would be an understatement.  You throw anything at ZFS, and it seems to use it in the most efficent way possible (including PCIe SSDs and battery-backed RAM disk devices with ultra-low latency).  There are also 3 levels of caching available with ZFS:<br /></p>
                <ol>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>ARC (Adaptive Replacement Cache), which is essentially intelligent memory caching<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>L2ARC, which is non-storage SSD read caching<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 30px; text-indent: -20px; " class="full-width">
                    <p style="text-indent: -20px; " class="paragraph_style"><span style="font-size: 14px; " class="Bullet">•</span><span style="width: 15px; " class="inline-block"></span>ZIL (ZFS intent log), which is SSD write caching<br /><br /></p>
                  </li>
                </ol>
                <p class="Body">More importantly, ZFS writes parity info with a variable-sized stripe.  This feature almost entirely eliminates poor performance, AND corrects the infamous RAID 5 Hole (data lost in the event of a power failure).<br /></p>
                <p class="Body"> <br /></p>
                <p class="paragraph_style_1">Conclusion:<br /></p>
                <p class="Body">Both ZFS and ReFS detect and repair data errors without dismounting volumes, but ZFS does a much better job.  ZFS uses checksums that trickle up through all data and metadata in the file system hierarchy.  ReFS approximates this using the integrity attribute, but it has a huge hit on performance and very high latency.   ZFS also supports more file system features and storage technologies (deduplication, PCI-e SSDs, Pro RAMdisks, compression, cloning, snapshots, encryption, and more). <br /></p>
                <p class="Body"> <br /></p>
                <p style="padding-bottom: 0pt; " class="Body">Consequently, <span class="style_1">ZFS wins hands down</span>.  However, don’t write ReFS off just yet.  Keep in mind that ZFS is very mature, and currently in production in massive enterprise environments.  ReFS has just been introduced by Microsoft – it’s essentially a “1.0” feature that is rough around the edges.  The important thing is that Microsoft wants a file system like ZFS, and it looks like they are moving in the right direction (which is a good thing).</p>
              </div>
              <div style="clear: both; height: 0px; line-height: 0px; " class="tinyText"> </div>
            </div>
            <div id="generic-body-attributes" class="Body"></div>
          </div>
          


          <div style="height: 400px; width: 700px;  height: 400px; left: 0px; position: absolute; top: 15px; width: 700px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 700px; ">
              <img src="25_Microsoft_ReFS_vs_Oracle_ZFS_-_FIGHT_files/shapeimage_1.png" alt="" style="height: 400px; left: 0px; position: absolute; top: 0px; width: 700px; visibility: hidden; " id="generic-picture-attributes" />
            </div>
          </div>
          <div style="height: 0px; line-height: 0px; " class="spacer"> </div>
        </div>
        <div style="height: 150px; margin-left: 0px; position: relative; width: 700px; z-index: 15; " id="footer_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div id="id3" style="height: 30px; left: 350px; position: absolute; top: 30px; width: 310px; z-index: 1; " class="style_SkipStroke_4 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_310_30" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="Next"><a class="iWebBlogNext" title="" href="">next &gt;</a></p>
              </div>
            </div>
          </div>
          


          <div id="id4" style="height: 30px; left: 40px; position: absolute; top: 30px; width: 310px; z-index: 1; " class="style_SkipStroke_4 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_310_30" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="Previous"><a class="iWebBlogPrev" title="" href="">&lt; previous</a></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>


